{
  "path": ".copilot/process/self-improvement.md",
  "title": "Self-improvement loop for agent instructions",
  "vecs": [
    {
      "text": "# Self-improvement loop for `.copilot/` instructions\n\nKey points\n- Before non-trivial work, run an **Instruction Adequacy Check**: do we have enough ExoFrame-specific guidance to act and verify?\n- If guidance is missing, do a **Doc Patch Loop**: add the smallest, task-scoped update to `.copilot/`, then rebuild/validate, then continue the primary task.\n- Keep updates grounded: add checklists, examples, and commands; avoid speculative “nice-to-have” prose.\n- Treat doc changes like code changes: minimal diff, clear success criteria, and a regression test when appropriate.\n\n## Instruction adequacy check\n\nUse this at the start of a session or before a multi-step change.\n\n1. **Classify the task**\n   - TDD / bugfix / refactor / docs / CI / security / portal permissions / RAG usage",
      "vector": [
        0.8745098039215686,
        0.3607843137254902,
        0.43529411764705883,
        0.9294117647058824,
        0.26666666666666666,
        0.03137254901960784,
        0.1607843137254902,
        0.9019607843137255,
        0.7333333333333333,
        0.4588235294117647,
        0.8274509803921568,
        0.3686274509803922,
        0.2823529411764706,
        0.48627450980392156,
        0.8823529411764706,
        0.12549019607843137,
        0.5019607843137255,
        0.19607843137254902,
        0.792156862745098,
        0.5647058823529412,
        0.47058823529411764,
        0.2196078431372549,
        0.8862745098039215,
        0.6941176470588235,
        0.8509803921568627,
        0.13333333333333333,
        0.10980392156862745,
        0.3568627450980392,
        0.6862745098039216,
        0.403921568627451,
        0.3176470588235294,
        0.4549019607843137,
        0.8745098039215686,
        0.3607843137254902,
        0.43529411764705883,
        0.9294117647058824,
        0.26666666666666666,
        0.03137254901960784,
        0.1607843137254902,
        0.9019607843137255,
        0.7333333333333333,
        0.4588235294117647,
        0.8274509803921568,
        0.3686274509803922,
        0.2823529411764706,
        0.48627450980392156,
        0.8823529411764706,
        0.12549019607843137,
        0.5019607843137255,
        0.19607843137254902,
        0.792156862745098,
        0.5647058823529412,
        0.47058823529411764,
        0.2196078431372549,
        0.8862745098039215,
        0.6941176470588235,
        0.8509803921568627,
        0.13333333333333333,
        0.10980392156862745,
        0.3568627450980392,
        0.6862745098039216,
        0.403921568627451,
        0.3176470588235294,
        0.4549019607843137
      ]
    },
    {
      "text": "2. **Retrieve relevant instructions**\n   - Start with `.copilot/cross-reference.md` to find the primary docs.\n   - Read the provider guide for the active model:\n     - Claude: `.copilot/providers/claude.md`\n     - OpenAI: `.copilot/providers/openai.md`\n     - Google: `.copilot/providers/google.md`\n   - Inject additional docs via `scripts/inject_agent_context.ts` when needed.\n\n3. **Adequacy verdict**\n   - ✅ Adequate if the docs specify:\n     - what files/patterns to use (ExoFrame-specific)\n     - what invariants to preserve\n     - what verification to run (tests/lint/CI checks)\n   - ❌ Inadequate if any of these are missing or ambiguous.\n\n## Doc patch loop (when inadequate)",
      "vector": [
        0.796078431372549,
        0.2980392156862745,
        0.6823529411764706,
        0.3176470588235294,
        0.41568627450980394,
        0.6941176470588235,
        0.8705882352941177,
        0.7254901960784313,
        0.803921568627451,
        0.39215686274509803,
        0.3215686274509804,
        0.011764705882352941,
        0.7372549019607844,
        0.5803921568627451,
        0.33725490196078434,
        0.06666666666666667,
        0.34901960784313724,
        0.7019607843137254,
        0.39215686274509803,
        0.16862745098039217,
        0.30980392156862746,
        0.8862745098039215,
        0.37254901960784315,
        0.16862745098039217,
        0.9450980392156862,
        0.5490196078431373,
        0.058823529411764705,
        0.7647058823529411,
        0.6745098039215687,
        0.7490196078431373,
        0.2901960784313726,
        0.5764705882352941,
        0.796078431372549,
        0.2980392156862745,
        0.6823529411764706,
        0.3176470588235294,
        0.41568627450980394,
        0.6941176470588235,
        0.8705882352941177,
        0.7254901960784313,
        0.803921568627451,
        0.39215686274509803,
        0.3215686274509804,
        0.011764705882352941,
        0.7372549019607844,
        0.5803921568627451,
        0.33725490196078434,
        0.06666666666666667,
        0.34901960784313724,
        0.7019607843137254,
        0.39215686274509803,
        0.16862745098039217,
        0.30980392156862746,
        0.8862745098039215,
        0.37254901960784315,
        0.16862745098039217,
        0.9450980392156862,
        0.5490196078431373,
        0.058823529411764705,
        0.7647058823529411,
        0.6745098039215687,
        0.7490196078431373,
        0.2901960784313726,
        0.5764705882352941
      ]
    },
    {
      "text": "1. **List the gaps** (actionable, not vague)\n   - Examples:\n     - “No guidance on which test helper to use for this subsystem.”\n     - “No canonical command for validating manifest/chunks after .copilot/ edits.”\n     - “No example of the required output format for this provider in this scenario.”\n\n2. **Choose the smallest fix**\n   - Add a section to an existing doc when the topic clearly belongs there.\n   - Add a prompt template when the goal is reliable behavior (format/budgets/checklists).\n   - Add a cross-reference row/topic when discovery is the main problem.\n\n3. **Apply the doc patch (minimal diff)**\n   - Keep changes directly relevant to the current user request.\n   - Prefer checklists + examples over long narrative.",
      "vector": [
        0.47843137254901963,
        0.4549019607843137,
        0.5607843137254902,
        0.2784313725490196,
        0.7725490196078432,
        0.23921568627450981,
        0.23921568627450981,
        0.3803921568627451,
        0.26666666666666666,
        0.7764705882352941,
        0.9333333333333333,
        0.023529411764705882,
        0.12549019607843137,
        0.09803921568627451,
        0.9607843137254902,
        0.24313725490196078,
        0.32941176470588235,
        0.34901960784313724,
        0.7843137254901961,
        0.5333333333333333,
        0.9176470588235294,
        0.611764705882353,
        0.6274509803921569,
        0.8784313725490196,
        0.1607843137254902,
        0.7764705882352941,
        0.09803921568627451,
        0.2,
        0.1450980392156863,
        0.38823529411764707,
        0.5607843137254902,
        0.4588235294117647,
        0.47843137254901963,
        0.4549019607843137,
        0.5607843137254902,
        0.2784313725490196,
        0.7725490196078432,
        0.23921568627450981,
        0.23921568627450981,
        0.3803921568627451,
        0.26666666666666666,
        0.7764705882352941,
        0.9333333333333333,
        0.023529411764705882,
        0.12549019607843137,
        0.09803921568627451,
        0.9607843137254902,
        0.24313725490196078,
        0.32941176470588235,
        0.34901960784313724,
        0.7843137254901961,
        0.5333333333333333,
        0.9176470588235294,
        0.611764705882353,
        0.6274509803921569,
        0.8784313725490196,
        0.1607843137254902,
        0.7764705882352941,
        0.09803921568627451,
        0.2,
        0.1450980392156863,
        0.38823529411764707,
        0.5607843137254902,
        0.4588235294117647
      ]
    },
    {
      "text": "4. **Rebuild + validate `.copilot/` artifacts**\n   - Rebuild manifest/chunks:\n     - `deno run --allow-read --allow-write scripts/build_agents_index.ts`\n   - Verify freshness:\n     - `deno run --allow-read scripts/verify_manifest_fresh.ts`\n   - Rebuild embeddings (baseline):\n     - `deno run --allow-read --allow-write scripts/build_agents_embeddings.ts --mode mock`\n   - Validate agent docs:\n     - `deno run --allow-read scripts/validate_agents_docs.ts`\n\n5. **Add enforcement (when it prevents recurrence)**\n   - If a gap caused real friction, add/extend a focused test under `tests/agents/`.\n\n6. **Resume the primary task**\n   - Re-run context injection if needed (docs changed).\n\n## Gap taxonomy (what to look for)",
      "vector": [
        0.5764705882352941,
        0.21176470588235294,
        0.6352941176470588,
        0.11764705882352941,
        0.9882352941176471,
        0.8274509803921568,
        0.42745098039215684,
        0.4196078431372549,
        0.43529411764705883,
        0.5686274509803921,
        0.23529411764705882,
        0.0392156862745098,
        0.9764705882352941,
        0.21176470588235294,
        0.25098039215686274,
        0.984313725490196,
        0.8705882352941177,
        0.9215686274509803,
        0.7254901960784313,
        0.17647058823529413,
        0.1411764705882353,
        0.5137254901960784,
        0.16862745098039217,
        0.38823529411764707,
        0.21568627450980393,
        0.30196078431372547,
        0.9137254901960784,
        0.2,
        0.6078431372549019,
        0.12156862745098039,
        0.4117647058823529,
        0.7058823529411765,
        0.5764705882352941,
        0.21176470588235294,
        0.6352941176470588,
        0.11764705882352941,
        0.9882352941176471,
        0.8274509803921568,
        0.42745098039215684,
        0.4196078431372549,
        0.43529411764705883,
        0.5686274509803921,
        0.23529411764705882,
        0.0392156862745098,
        0.9764705882352941,
        0.21176470588235294,
        0.25098039215686274,
        0.984313725490196,
        0.8705882352941177,
        0.9215686274509803,
        0.7254901960784313,
        0.17647058823529413,
        0.1411764705882353,
        0.5137254901960784,
        0.16862745098039217,
        0.38823529411764707,
        0.21568627450980393,
        0.30196078431372547,
        0.9137254901960784,
        0.2,
        0.6078431372549019,
        0.12156862745098039,
        0.4117647058823529,
        0.7058823529411765
      ]
    },
    {
      "text": "- **Missing examples**: no concrete ExoFrame-specific snippet for the task.\n- **Missing commands**: no “what to run” for verification/build/validation.\n- **Missing invariants**: unclear what behavior must not change.\n- **Missing cross-links**: docs exist but are hard to discover.\n- **Missing provider mapping**: advice exists but doesn’t translate to Claude/OpenAI/Gemini workflow.\n- **Missing tests**: doc changes not guarded; regressions likely.",
      "vector": [
        0.03529411764705882,
        0.11764705882352941,
        0.2784313725490196,
        0.5764705882352941,
        0.49411764705882355,
        0.00392156862745098,
        0.7333333333333333,
        0.4117647058823529,
        0.8823529411764706,
        0.27058823529411763,
        0.26666666666666666,
        0.5647058823529412,
        0.7294117647058823,
        0.5882352941176471,
        0.6862745098039216,
        0.8745098039215686,
        0.10196078431372549,
        0.00784313725490196,
        0.8588235294117647,
        0.7294117647058823,
        0.5490196078431373,
        0.3568627450980392,
        0.48627450980392156,
        0.4823529411764706,
        0.06274509803921569,
        0.2980392156862745,
        0.25882352941176473,
        0.4196078431372549,
        0.5529411764705883,
        0.8117647058823529,
        0.5137254901960784,
        0.5490196078431373,
        0.03529411764705882,
        0.11764705882352941,
        0.2784313725490196,
        0.5764705882352941,
        0.49411764705882355,
        0.00392156862745098,
        0.7333333333333333,
        0.4117647058823529,
        0.8823529411764706,
        0.27058823529411763,
        0.26666666666666666,
        0.5647058823529412,
        0.7294117647058823,
        0.5882352941176471,
        0.6862745098039216,
        0.8745098039215686,
        0.10196078431372549,
        0.00784313725490196,
        0.8588235294117647,
        0.7294117647058823,
        0.5490196078431373,
        0.3568627450980392,
        0.48627450980392156,
        0.4823529411764706,
        0.06274509803921569,
        0.2980392156862745,
        0.25882352941176473,
        0.4196078431372549,
        0.5529411764705883,
        0.8117647058823529,
        0.5137254901960784,
        0.5490196078431373
      ]
    },
    {
      "text": "Do / Don’t\n- ✅ Do keep doc updates minimal and scoped to the current task.\n- ✅ Do ask 1–3 clarifying questions if the requirement is ambiguous before changing docs.\n- ✅ Do rebuild `.copilot/manifest.json`, chunks, and embeddings after agent doc edits.\n- ✅ Do add a regression test when a missing instruction caused a real failure.\n- ❌ Don’t broaden scope into “general best practices” unrelated to ExoFrame.\n- ❌ Don’t update many docs at once without a clear gap list.\n\nCanonical prompt (short)\n\"Before implementing changes, run an Instruction Adequacy Check against .copilot/. If instructions are insufficient, patch .copilot/ with the smallest update needed (doc/template/cross-reference), rebuild/validate artifacts, then proceed with the primary task using the improved instructions.\"\n\nExamples",
      "vector": [
        0.49019607843137253,
        0.5568627450980392,
        0.6549019607843137,
        0.27450980392156865,
        0.9882352941176471,
        0.4392156862745098,
        0.9725490196078431,
        0.592156862745098,
        0.18823529411764706,
        0.9176470588235294,
        0.050980392156862744,
        0.8901960784313725,
        0.08235294117647059,
        0.20392156862745098,
        0.6352941176470588,
        0.00784313725490196,
        0.5568627450980392,
        0.34901960784313724,
        0.7019607843137254,
        0.9882352941176471,
        0.10980392156862745,
        0.49411764705882355,
        0.8823529411764706,
        0.21176470588235294,
        0.7098039215686275,
        0.054901960784313725,
        0.48627450980392156,
        0.25098039215686274,
        0.023529411764705882,
        0.3411764705882353,
        0.42745098039215684,
        0.6666666666666666,
        0.49019607843137253,
        0.5568627450980392,
        0.6549019607843137,
        0.27450980392156865,
        0.9882352941176471,
        0.4392156862745098,
        0.9725490196078431,
        0.592156862745098,
        0.18823529411764706,
        0.9176470588235294,
        0.050980392156862744,
        0.8901960784313725,
        0.08235294117647059,
        0.20392156862745098,
        0.6352941176470588,
        0.00784313725490196,
        0.5568627450980392,
        0.34901960784313724,
        0.7019607843137254,
        0.9882352941176471,
        0.10980392156862745,
        0.49411764705882355,
        0.8823529411764706,
        0.21176470588235294,
        0.7098039215686275,
        0.054901960784313725,
        0.48627450980392156,
        0.25098039215686274,
        0.023529411764705882,
        0.3411764705882353,
        0.42745098039215684,
        0.6666666666666666
      ]
    },
    {
      "text": "- Example: Missing test helper guidance\n  - Task: “Add regression tests for a CLI config edge case.”\n  - Gap: no mention of the correct test context helper.\n  - Patch: add a small section to `.copilot/tests/testing.md` pointing to `createCliTestContext()` usage for CLI tests; add one focused test under `tests/agents/` to ensure the section exists.\n\n- Example: Missing provider-specific output contract\n  - Task: “Perform a multi-file refactor with OpenAI.”\n  - Gap: provider doc doesn’t enforce diff-first structure.\n  - Patch: add/update a prompt template under `.copilot/prompts/` requiring Files → Plan → Diffs → Verification.\n## Related Documents",
      "vector": [
        0.807843137254902,
        0.8901960784313725,
        0.043137254901960784,
        0.5803921568627451,
        0.27450980392156865,
        0.7215686274509804,
        0.5137254901960784,
        0.23137254901960785,
        0.1607843137254902,
        0.3215686274509804,
        0.34509803921568627,
        0.19607843137254902,
        0.6509803921568628,
        1,
        0.984313725490196,
        0.4588235294117647,
        0.027450980392156862,
        0.3764705882352941,
        0.11372549019607843,
        0.9686274509803922,
        0.050980392156862744,
        0.10588235294117647,
        0.09803921568627451,
        0.9254901960784314,
        0.07450980392156863,
        0.27058823529411763,
        0.788235294117647,
        0.1411764705882353,
        0.5058823529411764,
        0.09803921568627451,
        0.8156862745098039,
        0.4470588235294118,
        0.807843137254902,
        0.8901960784313725,
        0.043137254901960784,
        0.5803921568627451,
        0.27450980392156865,
        0.7215686274509804,
        0.5137254901960784,
        0.23137254901960785,
        0.1607843137254902,
        0.3215686274509804,
        0.34509803921568627,
        0.19607843137254902,
        0.6509803921568628,
        1,
        0.984313725490196,
        0.4588235294117647,
        0.027450980392156862,
        0.3764705882352941,
        0.11372549019607843,
        0.9686274509803922,
        0.050980392156862744,
        0.10588235294117647,
        0.09803921568627451,
        0.9254901960784314,
        0.07450980392156863,
        0.27058823529411763,
        0.788235294117647,
        0.1411764705882353,
        0.5058823529411764,
        0.09803921568627451,
        0.8156862745098039,
        0.4470588235294118
      ]
    },
    {
      "text": "- [Review-Research-Improvement Pattern](./review-research-improvement.md) - For architectural reviews and improvement planning (larger scope than instruction gaps)",
      "vector": [
        0.5843137254901961,
        0.5058823529411764,
        0.34509803921568627,
        0.9529411764705882,
        0.21568627450980393,
        0.7803921568627451,
        0.5215686274509804,
        0.6392156862745098,
        0.403921568627451,
        0.9607843137254902,
        0.9215686274509803,
        0.48627450980392156,
        0.4627450980392157,
        0.16862745098039217,
        0.788235294117647,
        0.7333333333333333,
        0.058823529411764705,
        0.03137254901960784,
        0.17254901960784313,
        0.7843137254901961,
        0.3803921568627451,
        0.984313725490196,
        0.03529411764705882,
        0.20392156862745098,
        0.792156862745098,
        0.6431372549019608,
        0.14901960784313725,
        0.1568627450980392,
        0.9647058823529412,
        0.5882352941176471,
        0.3764705882352941,
        0.6431372549019608,
        0.5843137254901961,
        0.5058823529411764,
        0.34509803921568627,
        0.9529411764705882,
        0.21568627450980393,
        0.7803921568627451,
        0.5215686274509804,
        0.6392156862745098,
        0.403921568627451,
        0.9607843137254902,
        0.9215686274509803,
        0.48627450980392156,
        0.4627450980392157,
        0.16862745098039217,
        0.788235294117647,
        0.7333333333333333,
        0.058823529411764705,
        0.03137254901960784,
        0.17254901960784313,
        0.7843137254901961,
        0.3803921568627451,
        0.984313725490196,
        0.03529411764705882,
        0.20392156862745098,
        0.792156862745098,
        0.6431372549019608,
        0.14901960784313725,
        0.1568627450980392,
        0.9647058823529412,
        0.5882352941176471,
        0.3764705882352941,
        0.6431372549019608
      ]
    }
  ]
}