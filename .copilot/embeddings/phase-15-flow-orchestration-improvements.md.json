{
  "path": ".copilot/planning/phase-15-flow-orchestration-improvements.md",
  "title": "phase-15-flow-orchestration-improvements.md",
  "vecs": [
    {
      "text": "# Phase 15: Flow Orchestration Improvements\n\n**Created:** January 4, 2026\n**Status:** Implemented ‚úÖ\n**Priority:** High\n**Completed:** January 8, 2026\n\n## Executive Summary\n\nThis document proposes enhancements to ExoFrame's Flow orchestration system based on analysis of current implementation and state-of-the-art agent orchestration patterns. The focus is on adding **quality gates**, **feedback loops**, **LLM-as-a-Judge evaluation**, and **conditional branching** while preserving ExoFrame's core principles of file-based workflows and traceable execution.\n\n---\n\n## Implementation Status",
      "vector": [
        0.03137254901960784,
        0.8,
        0.34509803921568627,
        0.043137254901960784,
        0.5568627450980392,
        0.06666666666666667,
        0.6705882352941176,
        0.4666666666666667,
        0.7568627450980392,
        0.7686274509803922,
        0.5490196078431373,
        0.08235294117647059,
        0.4392156862745098,
        0.596078431372549,
        0.6784313725490196,
        0.27058823529411763,
        0.3333333333333333,
        0.20784313725490197,
        0.5215686274509804,
        0.28627450980392155,
        0.7411764705882353,
        0.058823529411764705,
        0.12941176470588237,
        0.8352941176470589,
        0.03529411764705882,
        0.7372549019607844,
        0.9686274509803922,
        0.49411764705882355,
        0.15294117647058825,
        0.00392156862745098,
        0.06666666666666667,
        0.6274509803921569,
        0.03137254901960784,
        0.8,
        0.34509803921568627,
        0.043137254901960784,
        0.5568627450980392,
        0.06666666666666667,
        0.6705882352941176,
        0.4666666666666667,
        0.7568627450980392,
        0.7686274509803922,
        0.5490196078431373,
        0.08235294117647059,
        0.4392156862745098,
        0.596078431372549,
        0.6784313725490196,
        0.27058823529411763,
        0.3333333333333333,
        0.20784313725490197,
        0.5215686274509804,
        0.28627450980392155,
        0.7411764705882353,
        0.058823529411764705,
        0.12941176470588237,
        0.8352941176470589,
        0.03529411764705882,
        0.7372549019607844,
        0.9686274509803922,
        0.49411764705882355,
        0.15294117647058825,
        0.00392156862745098,
        0.06666666666666667,
        0.6274509803921569
      ]
    },
    {
      "text": "| Component | Status | Location | Tests |\n|-----------|--------|----------|-------|\n| ConditionEvaluator | ‚úÖ Complete | `src/flows/condition_evaluator.ts` | ‚úÖ 21 tests |\n| EvaluationCriteria | ‚úÖ Complete | `src/flows/evaluation_criteria.ts` | ‚úÖ 37 tests |\n| GateEvaluator | ‚úÖ Complete | `src/flows/gate_evaluator.ts` | ‚úÖ 8 tests |\n| JudgeEvaluator | ‚úÖ Complete | `src/flows/judge_evaluator.ts` | ‚úÖ 14 tests |\n| FeedbackLoop | ‚úÖ Complete | `src/flows/feedback_loop.ts` | ‚úÖ 15 tests |\n| FlowRunner Condition Integration | ‚úÖ Complete | `src/flows/flow_runner.ts` | ‚úÖ Included in flow_runner_test |\n| Schema Extensions | ‚úÖ Complete | `src/schemas/flow.ts` | ‚úÖ Included in existing tests |\n| Quality Judge Blueprint | ‚úÖ Complete | `Blueprints/Agents/quality-judge.md` | N/A |\n| LLM Judge Template | ‚úÖ Complete | `Blueprints/Flows/templates/llm-judge-code-review.flow.template.ts` | N/A |\n| Self-Correcting Template | ‚úÖ Complete | `Blueprints/Flows/templates/self-correcting.flow.template.ts` | N/A |",
      "vector": [
        0.4470588235294118,
        0.06274509803921569,
        0.9450980392156862,
        0.35294117647058826,
        0.7764705882352941,
        0.3137254901960784,
        0.9137254901960784,
        0.7450980392156863,
        0.10980392156862745,
        0.011764705882352941,
        0.07450980392156863,
        0.22745098039215686,
        0.6705882352941176,
        0.47843137254901963,
        0.8980392156862745,
        0.6745098039215687,
        0.13725490196078433,
        0.9803921568627451,
        0.40784313725490196,
        0.14901960784313725,
        0.47843137254901963,
        0.8431372549019608,
        0.6470588235294118,
        0.8274509803921568,
        0.023529411764705882,
        0.10980392156862745,
        0.596078431372549,
        0.5098039215686274,
        0.8705882352941177,
        0.7098039215686275,
        0.8352941176470589,
        0.7529411764705882,
        0.4470588235294118,
        0.06274509803921569,
        0.9450980392156862,
        0.35294117647058826,
        0.7764705882352941,
        0.3137254901960784,
        0.9137254901960784,
        0.7450980392156863,
        0.10980392156862745,
        0.011764705882352941,
        0.07450980392156863,
        0.22745098039215686,
        0.6705882352941176,
        0.47843137254901963,
        0.8980392156862745,
        0.6745098039215687,
        0.13725490196078433,
        0.9803921568627451,
        0.40784313725490196,
        0.14901960784313725,
        0.47843137254901963,
        0.8431372549019608,
        0.6470588235294118,
        0.8274509803921568,
        0.023529411764705882,
        0.10980392156862745,
        0.596078431372549,
        0.5098039215686274,
        0.8705882352941177,
        0.7098039215686275,
        0.8352941176470589,
        0.7529411764705882
      ]
    },
    {
      "text": "**Current Test Count:** 175 flow tests passing\n\n---\n\n## Test Plan\n\n### Existing Tests (175 total)",
      "vector": [
        0.07058823529411765,
        0.42745098039215684,
        0.22745098039215686,
        0.5607843137254902,
        0.9803921568627451,
        0.27058823529411763,
        0.7568627450980392,
        0.6980392156862745,
        0.09803921568627451,
        0.24705882352941178,
        0.5843137254901961,
        0.21176470588235294,
        0.7372549019607844,
        0.3058823529411765,
        0.7764705882352941,
        0.5450980392156862,
        0.07058823529411765,
        0.1450980392156863,
        0.20784313725490197,
        0.20392156862745098,
        0.5372549019607843,
        0.5411764705882353,
        0.1607843137254902,
        0.5215686274509804,
        0.4470588235294118,
        0.1450980392156863,
        0.8235294117647058,
        0.7098039215686275,
        0.9176470588235294,
        0.25882352941176473,
        0.2,
        0.4117647058823529,
        0.07058823529411765,
        0.42745098039215684,
        0.22745098039215686,
        0.5607843137254902,
        0.9803921568627451,
        0.27058823529411763,
        0.7568627450980392,
        0.6980392156862745,
        0.09803921568627451,
        0.24705882352941178,
        0.5843137254901961,
        0.21176470588235294,
        0.7372549019607844,
        0.3058823529411765,
        0.7764705882352941,
        0.5450980392156862,
        0.07058823529411765,
        0.1450980392156863,
        0.20784313725490197,
        0.20392156862745098,
        0.5372549019607843,
        0.5411764705882353,
        0.1607843137254902,
        0.5215686274509804,
        0.4470588235294118,
        0.1450980392156863,
        0.8235294117647058,
        0.7098039215686275,
        0.9176470588235294,
        0.25882352941176473,
        0.2,
        0.4117647058823529
      ]
    },
    {
      "text": "| Test File | Tests | Coverage |\n|-----------|-------|----------|\n| `condition_evaluator_test.ts` | 21 | Condition expressions, context building, validation |\n| `gate_evaluator_test.ts` | 8 | Gate pass/fail, retry actions, score thresholds |\n| `judge_evaluator_test.ts` | 14 | JSON parsing, heuristics, score normalization |\n| `feedback_loop_test.ts` | 15 | Iterations, stop conditions, improvement agents |\n| `evaluation_criteria_test.ts` | 37 | CRITERIA, weighted scores, prompt building |\n| `flow_runner_test.ts` | ~40 | Execution, dependencies, transforms, conditions |\n| `dependency_resolver_test.ts` | ~15 | DAG resolution, cycle detection |\n| `transforms_test.ts` | ~15 | Transform functions |\n| `define_flow_test.ts` | ~10 | Flow definition, validation |",
      "vector": [
        0.24705882352941178,
        0.30196078431372547,
        0.054901960784313725,
        0.5686274509803921,
        0.10588235294117647,
        0.6,
        0.11372549019607843,
        0.9607843137254902,
        0.3215686274509804,
        0.34509803921568627,
        0.7764705882352941,
        0.4235294117647059,
        0.8627450980392157,
        0.9254901960784314,
        0.27058823529411763,
        0.4,
        0.14901960784313725,
        0.803921568627451,
        0.18823529411764706,
        0.6392156862745098,
        0.7215686274509804,
        0.6235294117647059,
        0.47058823529411764,
        0.9137254901960784,
        0.8235294117647058,
        0.25882352941176473,
        0.8980392156862745,
        0.32941176470588235,
        0.00392156862745098,
        0.7843137254901961,
        0.5098039215686274,
        0.5411764705882353,
        0.24705882352941178,
        0.30196078431372547,
        0.054901960784313725,
        0.5686274509803921,
        0.10588235294117647,
        0.6,
        0.11372549019607843,
        0.9607843137254902,
        0.3215686274509804,
        0.34509803921568627,
        0.7764705882352941,
        0.4235294117647059,
        0.8627450980392157,
        0.9254901960784314,
        0.27058823529411763,
        0.4,
        0.14901960784313725,
        0.803921568627451,
        0.18823529411764706,
        0.6392156862745098,
        0.7215686274509804,
        0.6235294117647059,
        0.47058823529411764,
        0.9137254901960784,
        0.8235294117647058,
        0.25882352941176473,
        0.8980392156862745,
        0.32941176470588235,
        0.00392156862745098,
        0.7843137254901961,
        0.5098039215686274,
        0.5411764705882353
      ]
    },
    {
      "text": "### Test Implementation (All Complete ‚úÖ)\n\n#### 1. JudgeEvaluator Tests (`tests/flows/judge_evaluator_test.ts`) - ‚úÖ **COMPLETE**",
      "vector": [
        0.054901960784313725,
        0.5843137254901961,
        0.19215686274509805,
        0.3686274509803922,
        0.9411764705882353,
        0.4627450980392157,
        0.27450980392156865,
        0.14901960784313725,
        0.5058823529411764,
        0.10196078431372549,
        0.4,
        0.47843137254901963,
        0.10980392156862745,
        0.3176470588235294,
        0.13725490196078433,
        0.043137254901960784,
        0.34509803921568627,
        0.7607843137254902,
        0.9098039215686274,
        0.38823529411764707,
        0.06666666666666667,
        0.3764705882352941,
        0.9882352941176471,
        0.14901960784313725,
        0.23529411764705882,
        0.4745098039215686,
        0.30980392156862746,
        0.13333333333333333,
        0.16862745098039217,
        1,
        0.17254901960784313,
        0.34901960784313724,
        0.054901960784313725,
        0.5843137254901961,
        0.19215686274509805,
        0.3686274509803922,
        0.9411764705882353,
        0.4627450980392157,
        0.27450980392156865,
        0.14901960784313725,
        0.5058823529411764,
        0.10196078431372549,
        0.4,
        0.47843137254901963,
        0.10980392156862745,
        0.3176470588235294,
        0.13725490196078433,
        0.043137254901960784,
        0.34509803921568627,
        0.7607843137254902,
        0.9098039215686274,
        0.38823529411764707,
        0.06666666666666667,
        0.3764705882352941,
        0.9882352941176471,
        0.14901960784313725,
        0.23529411764705882,
        0.4745098039215686,
        0.30980392156862746,
        0.13333333333333333,
        0.16862745098039217,
        1,
        0.17254901960784313,
        0.34901960784313724
      ]
    },
    {
      "text": "```typescript\n// Implemented tests (14 total):\nDeno.test(\"JudgeEvaluator: evaluates content with valid JSON response\");\nDeno.test(\"JudgeEvaluator: handles JSON in code block\");\nDeno.test(\"JudgeEvaluator: passes context to agent runner\");\nDeno.test(\"JudgeEvaluator: repairs malformed JSON with missing quotes\");\nDeno.test(\"JudgeEvaluator: falls back to heuristic parsing for non-JSON\");\nDeno.test(\"JudgeEvaluator: extracts score from text with percentage\");\nDeno.test(\"JudgeEvaluator: normalizes criterion score above 1.0\");\nDeno.test(\"JudgeEvaluator: clamps negative score to 0\");\nDeno.test(\"JudgeEvaluator: clamps score above 100 to 1.0\");\nDeno.test(\"JudgeEvaluator: handles multiple criteria scores\");\nDeno.test(\"JudgeEvaluator: handles agent runner error gracefully\");\nDeno.test(\"JudgeEvaluator: returns default evaluation for unparseable response\");\nDeno.test(\"JudgeEvaluator: implements JudgeInvoker interface\");\nDeno.test(\"createJudgeEvaluator: creates evaluator from agent runner\");\n```",
      "vector": [
        0.7607843137254902,
        0.49411764705882355,
        0.6941176470588235,
        0.2980392156862745,
        0.09411764705882353,
        0.5450980392156862,
        0.7254901960784313,
        0.23137254901960785,
        0.3686274509803922,
        0.09019607843137255,
        0.49411764705882355,
        0.807843137254902,
        0.7058823529411765,
        0.047058823529411764,
        0.21568627450980393,
        0.30980392156862746,
        0.7019607843137254,
        0.30980392156862746,
        0.5215686274509804,
        0.15294117647058825,
        0.36470588235294116,
        0.8627450980392157,
        0.09019607843137255,
        0.596078431372549,
        0.1411764705882353,
        0.6588235294117647,
        0.1411764705882353,
        0.396078431372549,
        0.11764705882352941,
        0.25098039215686274,
        0.3843137254901961,
        0.03529411764705882,
        0.7607843137254902,
        0.49411764705882355,
        0.6941176470588235,
        0.2980392156862745,
        0.09411764705882353,
        0.5450980392156862,
        0.7254901960784313,
        0.23137254901960785,
        0.3686274509803922,
        0.09019607843137255,
        0.49411764705882355,
        0.807843137254902,
        0.7058823529411765,
        0.047058823529411764,
        0.21568627450980393,
        0.30980392156862746,
        0.7019607843137254,
        0.30980392156862746,
        0.5215686274509804,
        0.15294117647058825,
        0.36470588235294116,
        0.8627450980392157,
        0.09019607843137255,
        0.596078431372549,
        0.1411764705882353,
        0.6588235294117647,
        0.1411764705882353,
        0.396078431372549,
        0.11764705882352941,
        0.25098039215686274,
        0.3843137254901961,
        0.03529411764705882
      ]
    },
    {
      "text": "#### 2. FeedbackLoop Tests (`tests/flows/feedback_loop_test.ts`) - ‚úÖ **COMPLETE**",
      "vector": [
        0.6509803921568628,
        0.054901960784313725,
        0.2235294117647059,
        0.5803921568627451,
        0.5803921568627451,
        0.49411764705882355,
        0.3411764705882353,
        0.9137254901960784,
        0.43137254901960786,
        0.4666666666666667,
        0.3568627450980392,
        0.35294117647058826,
        0.4666666666666667,
        0.7764705882352941,
        0.14901960784313725,
        0.1607843137254902,
        0.5411764705882353,
        0.7411764705882353,
        0.5607843137254902,
        0.788235294117647,
        0.8745098039215686,
        0.9333333333333333,
        0.5137254901960784,
        0.8196078431372549,
        0.5607843137254902,
        0.1607843137254902,
        0.9215686274509803,
        0.4117647058823529,
        0.3568627450980392,
        0.24313725490196078,
        0.050980392156862744,
        0.1803921568627451,
        0.6509803921568628,
        0.054901960784313725,
        0.2235294117647059,
        0.5803921568627451,
        0.5803921568627451,
        0.49411764705882355,
        0.3411764705882353,
        0.9137254901960784,
        0.43137254901960786,
        0.4666666666666667,
        0.3568627450980392,
        0.35294117647058826,
        0.4666666666666667,
        0.7764705882352941,
        0.14901960784313725,
        0.1607843137254902,
        0.5411764705882353,
        0.7411764705882353,
        0.5607843137254902,
        0.788235294117647,
        0.8745098039215686,
        0.9333333333333333,
        0.5137254901960784,
        0.8196078431372549,
        0.5607843137254902,
        0.1607843137254902,
        0.9215686274509803,
        0.4117647058823529,
        0.3568627450980392,
        0.24313725490196078,
        0.050980392156862744,
        0.1803921568627451
      ]
    },
    {
      "text": "```typescript\n// Implemented tests (15 total):\nDeno.test(\"FeedbackLoop: stops when target score reached\");\nDeno.test(\"FeedbackLoop: stops at max iterations\");\nDeno.test(\"FeedbackLoop: tracks iterations correctly\");\nDeno.test(\"FeedbackLoop: stops on no improvement\");\nDeno.test(\"FeedbackLoop: stops on score degradation\");\nDeno.test(\"FeedbackLoop: stops on improvement agent error\");\nDeno.test(\"FeedbackLoop: calls improvement agent with correct parameters\");\nDeno.test(\"FeedbackLoop: uses improved content in subsequent iterations\");\nDeno.test(\"SimpleImprovementAgent: formats prompt correctly\");\nDeno.test(\"SimpleImprovementAgent: returns improved content\");\nDeno.test(\"createFeedbackLoop: creates functional feedback loop\");\nDeno.test(\"runSelfCorrectingAgent: runs complete self-correcting flow\");\nDeno.test(\"runSelfCorrectingAgent: improves through iterations\");\nDeno.test(\"FeedbackLoop: tracks total duration\");\nDeno.test(\"FeedbackLoop: handles multiple criteria\");\n```",
      "vector": [
        0.2627450980392157,
        0.8196078431372549,
        0.6274509803921569,
        0.5294117647058824,
        0.3803921568627451,
        0.26666666666666666,
        0.4117647058823529,
        0.23529411764705882,
        0.4392156862745098,
        0.8,
        0.6313725490196078,
        0,
        0.30980392156862746,
        0.19607843137254902,
        0.8352941176470589,
        0.027450980392156862,
        0.14901960784313725,
        0.5568627450980392,
        0.8509803921568627,
        0.43137254901960786,
        0.6235294117647059,
        0.11764705882352941,
        0.20784313725490197,
        0.596078431372549,
        0.7803921568627451,
        0.41568627450980394,
        0.20392156862745098,
        0.596078431372549,
        0.27450980392156865,
        0.9019607843137255,
        0.29411764705882354,
        0.3215686274509804,
        0.2627450980392157,
        0.8196078431372549,
        0.6274509803921569,
        0.5294117647058824,
        0.3803921568627451,
        0.26666666666666666,
        0.4117647058823529,
        0.23529411764705882,
        0.4392156862745098,
        0.8,
        0.6313725490196078,
        0,
        0.30980392156862746,
        0.19607843137254902,
        0.8352941176470589,
        0.027450980392156862,
        0.14901960784313725,
        0.5568627450980392,
        0.8509803921568627,
        0.43137254901960786,
        0.6235294117647059,
        0.11764705882352941,
        0.20784313725490197,
        0.596078431372549,
        0.7803921568627451,
        0.41568627450980394,
        0.20392156862745098,
        0.596078431372549,
        0.27450980392156865,
        0.9019607843137255,
        0.29411764705882354,
        0.3215686274509804
      ]
    },
    {
      "text": "#### 3. EvaluationCriteria Tests (`tests/flows/evaluation_criteria_test.ts`) - ‚úÖ **COMPLETE**",
      "vector": [
        0.2980392156862745,
        0.5607843137254902,
        0.4666666666666667,
        0.4,
        0.6078431372549019,
        0.9764705882352941,
        0.26666666666666666,
        0.5333333333333333,
        0.30196078431372547,
        0.43137254901960786,
        0.49411764705882355,
        0.6745098039215687,
        0.16862745098039217,
        0.011764705882352941,
        0.9098039215686274,
        0.33725490196078434,
        0.7450980392156863,
        0.1450980392156863,
        0.792156862745098,
        0.03529411764705882,
        0.011764705882352941,
        0.10980392156862745,
        0.054901960784313725,
        0.6666666666666666,
        0.6862745098039216,
        0.6588235294117647,
        0.027450980392156862,
        0.5058823529411764,
        0.25098039215686274,
        0.2627450980392157,
        0.5529411764705883,
        0.8156862745098039,
        0.2980392156862745,
        0.5607843137254902,
        0.4666666666666667,
        0.4,
        0.6078431372549019,
        0.9764705882352941,
        0.26666666666666666,
        0.5333333333333333,
        0.30196078431372547,
        0.43137254901960786,
        0.49411764705882355,
        0.6745098039215687,
        0.16862745098039217,
        0.011764705882352941,
        0.9098039215686274,
        0.33725490196078434,
        0.7450980392156863,
        0.1450980392156863,
        0.792156862745098,
        0.03529411764705882,
        0.011764705882352941,
        0.10980392156862745,
        0.054901960784313725,
        0.6666666666666666,
        0.6862745098039216,
        0.6588235294117647,
        0.027450980392156862,
        0.5058823529411764,
        0.25098039215686274,
        0.2627450980392157,
        0.5529411764705883,
        0.8156862745098039
      ]
    },
    {
      "text": "```typescript\n// Implemented tests (37 total):\nDeno.test(\"CRITERIA: contains CODE_CORRECTNESS\");\nDeno.test(\"CRITERIA: contains HAS_TESTS\");\nDeno.test(\"CRITERIA: contains CODE_COMPLETENESS\");\nDeno.test(\"CRITERIA: contains NO_SECURITY_ISSUES\");\nDeno.test(\"CRITERIA: all criteria have valid schema\");\nDeno.test(\"CRITERION_SETS: contains CODE_REVIEW set\");\nDeno.test(\"CRITERION_SETS: contains MINIMAL_GATE set\");\nDeno.test(\"CRITERION_SETS: contains SECURITY_REVIEW set\");\nDeno.test(\"CRITERION_SETS: CODE_REVIEW includes key criteria\");\nDeno.test(\"getCriteriaByNames: retrieves single criterion\");\nDeno.test(\"getCriteriaByNames: retrieves multiple criteria\");\nDeno.test(\"getCriteriaByNames: handles hyphenated names\");\nDeno.test(\"getCriteriaByNames: handles lowercase names\");\nDeno.test(\"getCriteriaByNames: skips unknown criteria with warning\");\nDeno.test(\"getCriteriaByNames: returns empty array for all unknown\");\nDeno.test(\"calculateWeightedScore: calculates simple average\");\nDeno.test(\"calculateWeightedScore: applies weights correctly\");\nDeno.test(\"calculateWeightedScore: handles missing results\");\nDeno.test(\"calculateWeightedScore: returns 0 for empty criteria\");\nDeno.test(\"checkRequiredCriteria: passes when all required met\");\nDeno.test(\"checkRequiredCriteria: fails when required criterion below threshold\");\nDeno.test(\"checkRequiredCriteria: passes when no required criteria\");\nDeno.test(\"checkRequiredCriteria: uses custom threshold\");\nDeno.test(\"createCriterion: creates criterion with defaults\");\nDeno.test(\"createCriterion: creates criterion with custom options\");\nDeno.test(\"createCriterion: validates through schema\");\nDeno.test(\"buildEvaluationPrompt: includes content\");\nDeno.test(\"buildEvaluationPrompt: includes criteria descriptions\");\nDeno.test(\"buildEvaluationPrompt: includes context when provided\");\nDeno.test(\"buildEvaluationPrompt: omits context section when not provided\");\nDeno.test(\"buildEvaluationPrompt: marks required criteria\");\nDeno.test(\"buildEvaluationPrompt: sho",
      "vector": [
        0.5647058823529412,
        0.6823529411764706,
        0.8352941176470589,
        0.6196078431372549,
        0.3843137254901961,
        0.47058823529411764,
        0.3568627450980392,
        0.23529411764705882,
        0.7176470588235294,
        0.8352941176470589,
        0.5568627450980392,
        0.33725490196078434,
        0.22745098039215686,
        0.17254901960784313,
        0.8666666666666667,
        0.5333333333333333,
        0.7411764705882353,
        0.34509803921568627,
        0.8509803921568627,
        0.29411764705882354,
        0.32941176470588235,
        0.6078431372549019,
        0.5725490196078431,
        0.4,
        0.7254901960784313,
        0.11764705882352941,
        0.8588235294117647,
        0.17647058823529413,
        0.8980392156862745,
        0.5843137254901961,
        0.984313725490196,
        0.6,
        0.5647058823529412,
        0.6823529411764706,
        0.8352941176470589,
        0.6196078431372549,
        0.3843137254901961,
        0.47058823529411764,
        0.3568627450980392,
        0.23529411764705882,
        0.7176470588235294,
        0.8352941176470589,
        0.5568627450980392,
        0.33725490196078434,
        0.22745098039215686,
        0.17254901960784313,
        0.8666666666666667,
        0.5333333333333333,
        0.7411764705882353,
        0.34509803921568627,
        0.8509803921568627,
        0.29411764705882354,
        0.32941176470588235,
        0.6078431372549019,
        0.5725490196078431,
        0.4,
        0.7254901960784313,
        0.11764705882352941,
        0.8588235294117647,
        0.17647058823529413,
        0.8980392156862745,
        0.5843137254901961,
        0.984313725490196,
        0.6
      ]
    },
    {
      "text": "#### 4. Integration Tests - **P2**\n\n```typescript\n// In flow_runner_test.ts or new integration file:\nDeno.test(\"FlowRunner: executes gate step with judge evaluation\");\nDeno.test(\"FlowRunner: handles gate retry action\");\nDeno.test(\"FlowRunner: handles gate halt action\");\nDeno.test(\"FlowRunner: executes feedback loop step\");\nDeno.test(\"FlowRunner: branch step routes correctly\");\nDeno.test(\"FlowRunner: consensus step aggregates results\");\n```\n\n---\n\n## Remaining Implementation Tasks\n\n### Phase 15 Gaps Identified:",
      "vector": [
        0.6588235294117647,
        0.06666666666666667,
        0.5568627450980392,
        0.5058823529411764,
        0.10588235294117647,
        0.4627450980392157,
        0.33725490196078434,
        0.1843137254901961,
        0.15294117647058825,
        0.8862745098039215,
        0.5294117647058824,
        0.8862745098039215,
        0.4745098039215686,
        0.6941176470588235,
        0.6470588235294118,
        0.25098039215686274,
        0.8980392156862745,
        0.9490196078431372,
        0.2196078431372549,
        0.6784313725490196,
        0.06274509803921569,
        0.8901960784313725,
        0.09803921568627451,
        0.3176470588235294,
        0.3411764705882353,
        0.7058823529411765,
        0.27450980392156865,
        0.1568627450980392,
        0.6196078431372549,
        0.7725490196078432,
        0.5294117647058824,
        0.7843137254901961,
        0.6588235294117647,
        0.06666666666666667,
        0.5568627450980392,
        0.5058823529411764,
        0.10588235294117647,
        0.4627450980392157,
        0.33725490196078434,
        0.1843137254901961,
        0.15294117647058825,
        0.8862745098039215,
        0.5294117647058824,
        0.8862745098039215,
        0.4745098039215686,
        0.6941176470588235,
        0.6470588235294118,
        0.25098039215686274,
        0.8980392156862745,
        0.9490196078431372,
        0.2196078431372549,
        0.6784313725490196,
        0.06274509803921569,
        0.8901960784313725,
        0.09803921568627451,
        0.3176470588235294,
        0.3411764705882353,
        0.7058823529411765,
        0.27450980392156865,
        0.1568627450980392,
        0.6196078431372549,
        0.7725490196078432,
        0.5294117647058824,
        0.7843137254901961
      ]
    },
    {
      "text": "| Task | Status | Priority | Effort |\n|------|--------|----------|--------|\n| `judge_evaluator_test.ts` | ‚ùå Missing | P1 | 2h |\n| `feedback_loop_test.ts` | ‚ùå Missing | P1 | 2h |\n| `evaluation_criteria_test.ts` | ‚ùå Missing | P2 | 1h |\n| `self-correcting.flow.template.ts` | ‚ùå Missing | P3 | 1h |\n| Documentation Update (Phase 15.7) | ‚ö†Ô∏è Partial | P2 | 2h |\n\n### Recommended Completion Order:\n\n1. **Create `judge_evaluator_test.ts`** - Tests for LLM-as-a-Judge\n2. **Create `feedback_loop_test.ts`** - Tests for Reflexion pattern\n3. **Create `evaluation_criteria_test.ts`** - Tests for criteria library\n4. **Create `self-correcting.flow.template.ts`** - Template from spec\n5. **Update documentation** - Complete Phase 15.7\n\n---\n\n## Current State Analysis\n\n### Strengths ‚úÖ",
      "vector": [
        0.011764705882352941,
        0.41568627450980394,
        0.41568627450980394,
        0.06274509803921569,
        0.13725490196078433,
        0.5529411764705883,
        0.4627450980392157,
        0.3333333333333333,
        0.3764705882352941,
        0.054901960784313725,
        0.4392156862745098,
        0.3333333333333333,
        0.8117647058823529,
        0.5764705882352941,
        0.2784313725490196,
        0.3137254901960784,
        0.18823529411764706,
        0.9019607843137255,
        0.9725490196078431,
        0.10980392156862745,
        0.49019607843137253,
        0.25882352941176473,
        0.2823529411764706,
        0.16862745098039217,
        0.4980392156862745,
        0.6784313725490196,
        0.8274509803921568,
        0.10588235294117647,
        0.8627450980392157,
        0.8705882352941177,
        0.4666666666666667,
        0.403921568627451,
        0.011764705882352941,
        0.41568627450980394,
        0.41568627450980394,
        0.06274509803921569,
        0.13725490196078433,
        0.5529411764705883,
        0.4627450980392157,
        0.3333333333333333,
        0.3764705882352941,
        0.054901960784313725,
        0.4392156862745098,
        0.3333333333333333,
        0.8117647058823529,
        0.5764705882352941,
        0.2784313725490196,
        0.3137254901960784,
        0.18823529411764706,
        0.9019607843137255,
        0.9725490196078431,
        0.10980392156862745,
        0.49019607843137253,
        0.25882352941176473,
        0.2823529411764706,
        0.16862745098039217,
        0.4980392156862745,
        0.6784313725490196,
        0.8274509803921568,
        0.10588235294117647,
        0.8627450980392157,
        0.8705882352941177,
        0.4666666666666667,
        0.403921568627451
      ]
    },
    {
      "text": "1. **Solid Foundation**: Well-implemented DAG-based dependency resolution with topological sort\n2. **Parallel Execution**: Wave-based execution with configurable `maxParallelism`\n3. **Extensible Transforms**: Built-in transforms + custom function support\n4. **Comprehensive Logging**: Full activity journal integration\n5. **Error Handling**: Retry mechanism with backoff, `failFast` option\n6. **Template Library**: Pipeline, Fan-Out/Fan-In, and Staged templates\n\n### Identified Weaknesses üî¥ ‚Üí **Now Addressed** ‚úÖ",
      "vector": [
        0.7803921568627451,
        0.15294117647058825,
        0.2980392156862745,
        0.4588235294117647,
        0,
        0.3803921568627451,
        0.8980392156862745,
        0.788235294117647,
        0.07058823529411765,
        0.08627450980392157,
        0.7686274509803922,
        0.8705882352941177,
        0.3137254901960784,
        0.6039215686274509,
        0.8352941176470589,
        0.3333333333333333,
        0.6745098039215687,
        0.2,
        0.6431372549019608,
        0.24313725490196078,
        0.1803921568627451,
        0.20392156862745098,
        0.7450980392156863,
        0.33725490196078434,
        0.7647058823529411,
        0.8745098039215686,
        0.8274509803921568,
        0.996078431372549,
        0.43137254901960786,
        0.00784313725490196,
        0.9372549019607843,
        0,
        0.7803921568627451,
        0.15294117647058825,
        0.2980392156862745,
        0.4588235294117647,
        0,
        0.3803921568627451,
        0.8980392156862745,
        0.788235294117647,
        0.07058823529411765,
        0.08627450980392157,
        0.7686274509803922,
        0.8705882352941177,
        0.3137254901960784,
        0.6039215686274509,
        0.8352941176470589,
        0.3333333333333333,
        0.6745098039215687,
        0.2,
        0.6431372549019608,
        0.24313725490196078,
        0.1803921568627451,
        0.20392156862745098,
        0.7450980392156863,
        0.33725490196078434,
        0.7647058823529411,
        0.8745098039215686,
        0.8274509803921568,
        0.996078431372549,
        0.43137254901960786,
        0.00784313725490196,
        0.9372549019607843,
        0
      ]
    },
    {
      "text": "| Weakness                     | Impact                                               | Resolution |\n| ---------------------------- | ---------------------------------------------------- | --------------------- |\n| **Conditions not evaluated** | `condition` field in schema is ignored in FlowRunner | ‚úÖ ConditionEvaluator integrated into FlowRunner |\n| **No quality gates**         | Can't gate progression based on quality thresholds   | ‚úÖ GateEvaluator with configurable thresholds |\n| **No feedback loops**        | Steps can't iterate based on output quality          | ‚úÖ FeedbackLoop with Reflexion pattern |\n| **No LLM evaluation**        | No built-in way to assess output quality             | ‚úÖ JudgeEvaluator + EvaluationCriteria library |\n| **No dynamic routing**       | Can't branch based on step results                   | ‚úÖ Schema supports branch step type |\n| **No self-correction**       | Failed steps can only retry, not adapt               | ‚úÖ FeedbackLoop for iterative improvement |\n| **Output validation**        | No schema validation for step outputs                | ‚úÖ EvaluationCriteria for structured validation |\n| **No consensus mechanisms**  | Parallel workers can't vote/agree                    | ‚úÖ Schema supports consensus step type |",
      "vector": [
        0.32941176470588235,
        0.9137254901960784,
        0.9215686274509803,
        0.7333333333333333,
        0.8274509803921568,
        0.5686274509803921,
        0.788235294117647,
        0.39215686274509803,
        0.10588235294117647,
        0.09019607843137255,
        0.8156862745098039,
        0.054901960784313725,
        0.9529411764705882,
        0.7647058823529411,
        0.3803921568627451,
        0.33725490196078434,
        0.10588235294117647,
        0.8705882352941177,
        0.7607843137254902,
        0.25882352941176473,
        0.9490196078431372,
        0.27058823529411763,
        0.8862745098039215,
        0.9137254901960784,
        0.8745098039215686,
        0.48627450980392156,
        0.7568627450980392,
        0.03529411764705882,
        0.4392156862745098,
        0.5333333333333333,
        0.41568627450980394,
        0.6705882352941176,
        0.32941176470588235,
        0.9137254901960784,
        0.9215686274509803,
        0.7333333333333333,
        0.8274509803921568,
        0.5686274509803921,
        0.788235294117647,
        0.39215686274509803,
        0.10588235294117647,
        0.09019607843137255,
        0.8156862745098039,
        0.054901960784313725,
        0.9529411764705882,
        0.7647058823529411,
        0.3803921568627451,
        0.33725490196078434,
        0.10588235294117647,
        0.8705882352941177,
        0.7607843137254902,
        0.25882352941176473,
        0.9490196078431372,
        0.27058823529411763,
        0.8862745098039215,
        0.9137254901960784,
        0.8745098039215686,
        0.48627450980392156,
        0.7568627450980392,
        0.03529411764705882,
        0.4392156862745098,
        0.5333333333333333,
        0.41568627450980394,
        0.6705882352941176
      ]
    },
    {
      "text": "---\n\n## State-of-the-Art Patterns (Not Yet in ExoFrame)\n\n### 1. LLM-as-a-Judge Pattern\n\nUse a specialized LLM to evaluate outputs from other agents, providing:\n\n- Quality scores (0-1 scale)\n- Structured feedback for improvement\n- Pass/fail decisions for gates\n\n### 2. Reflexion Pattern\n\nAgent reflects on its own output, identifies issues, and iteratively improves:\n\n- Self-critique step after each major output\n- Improvement loop until quality threshold met\n- Maximum iteration limit to prevent infinite loops\n\n### 3. Constitutional AI Pattern\n\nOutputs checked against defined principles/constraints:\n\n- Define rules (e.g., \"code must have tests\", \"no TODO comments\")\n- Evaluate compliance\n- Iterate until compliant or max attempts\n\n### 4. Multi-Agent Debate Pattern",
      "vector": [
        0.25098039215686274,
        0.5333333333333333,
        0.9019607843137255,
        0.5882352941176471,
        1,
        0.6823529411764706,
        0.3843137254901961,
        0.06666666666666667,
        0.30980392156862746,
        0.03137254901960784,
        0.43137254901960786,
        0.803921568627451,
        0.8117647058823529,
        0.5686274509803921,
        0.4823529411764706,
        0.3254901960784314,
        0.23137254901960785,
        0.10588235294117647,
        1,
        0.6274509803921569,
        0.3607843137254902,
        0.807843137254902,
        0.00392156862745098,
        0.047058823529411764,
        0.054901960784313725,
        0.023529411764705882,
        0.09411764705882353,
        0.9254901960784314,
        0.9725490196078431,
        0.7490196078431373,
        0.7294117647058823,
        0.6666666666666666,
        0.25098039215686274,
        0.5333333333333333,
        0.9019607843137255,
        0.5882352941176471,
        1,
        0.6823529411764706,
        0.3843137254901961,
        0.06666666666666667,
        0.30980392156862746,
        0.03137254901960784,
        0.43137254901960786,
        0.803921568627451,
        0.8117647058823529,
        0.5686274509803921,
        0.4823529411764706,
        0.3254901960784314,
        0.23137254901960785,
        0.10588235294117647,
        1,
        0.6274509803921569,
        0.3607843137254902,
        0.807843137254902,
        0.00392156862745098,
        0.047058823529411764,
        0.054901960784313725,
        0.023529411764705882,
        0.09411764705882353,
        0.9254901960784314,
        0.9725490196078431,
        0.7490196078431373,
        0.7294117647058823,
        0.6666666666666666
      ]
    },
    {
      "text": "Multiple agents argue different perspectives:\n\n- Parallel analysis from different viewpoints\n- Structured debate/challenge phase\n- Synthesis that acknowledges disagreements\n\n### 5. Consensus Pattern\n\nMultiple agents vote or reach agreement:\n\n- Parallel execution of same task\n- Comparison/voting phase\n- Majority or weighted consensus\n\n---\n\n## Proposed Improvements\n\n### Phase 15.1: Implement Condition Evaluation\n\n**Problem**: `condition` field exists in schema but is never evaluated.\n\n**Solution**: Add condition evaluation before step execution:\n\n```typescript\n// In FlowRunner.executeStep()\nif (step.condition) {\n  const shouldExecute = this.evaluateCondition(step.condition, stepResults);\n  if (!shouldExecute) {\n    return { stepId, success: true, skipped: true, duration: 0, ... };\n  }\n}\n```",
      "vector": [
        0.0196078431372549,
        0.9882352941176471,
        1,
        0.00392156862745098,
        0.23529411764705882,
        0.43529411764705883,
        0.1450980392156863,
        0.5529411764705883,
        0.9176470588235294,
        0.2823529411764706,
        0.2784313725490196,
        0.8549019607843137,
        0.5215686274509804,
        0.4627450980392157,
        0.5725490196078431,
        0.984313725490196,
        0.1843137254901961,
        0.45098039215686275,
        0.08235294117647059,
        0.09019607843137255,
        0.07450980392156863,
        0.9019607843137255,
        0.6235294117647059,
        0.7294117647058823,
        0.20392156862745098,
        0.6078431372549019,
        0.7254901960784313,
        0.8823529411764706,
        0.3686274509803922,
        0.4235294117647059,
        0.2784313725490196,
        0.32941176470588235,
        0.0196078431372549,
        0.9882352941176471,
        1,
        0.00392156862745098,
        0.23529411764705882,
        0.43529411764705883,
        0.1450980392156863,
        0.5529411764705883,
        0.9176470588235294,
        0.2823529411764706,
        0.2784313725490196,
        0.8549019607843137,
        0.5215686274509804,
        0.4627450980392157,
        0.5725490196078431,
        0.984313725490196,
        0.1843137254901961,
        0.45098039215686275,
        0.08235294117647059,
        0.09019607843137255,
        0.07450980392156863,
        0.9019607843137255,
        0.6235294117647059,
        0.7294117647058823,
        0.20392156862745098,
        0.6078431372549019,
        0.7254901960784313,
        0.8823529411764706,
        0.3686274509803922,
        0.4235294117647059,
        0.2784313725490196,
        0.32941176470588235
      ]
    }
  ]
}